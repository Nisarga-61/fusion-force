{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import type { NextRequest } from \"next/server\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport function middleware(req: NextRequest) {\r\n  const res = NextResponse.next();\r\n  // Security headers\r\n  res.headers.set(\"X-Frame-Options\", \"DENY\");\r\n  res.headers.set(\"X-Content-Type-Options\", \"nosniff\");\r\n  res.headers.set(\"Referrer-Policy\", \"no-referrer\");\r\n  res.headers.set(\"Permissions-Policy\", \"camera=(), microphone=()\");\r\n  res.headers.set(\"Strict-Transport-Security\", \"max-age=63072000; includeSubDomains; preload\");\r\n  // Basic CSRF protection for API mutations: enforce same-origin\r\n  if (req.nextUrl.pathname.startsWith(\"/api\") && [\"POST\",\"PUT\",\"PATCH\",\"DELETE\"].includes(req.method)) {\r\n    const origin = req.headers.get(\"origin\");\r\n    const host = req.headers.get(\"host\");\r\n    if (origin && !origin.includes(host || \"\")) {\r\n      return new NextResponse(\"Forbidden\", { status: 403 });\r\n    }\r\n  }\r\n  return res;\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/api/:path*\", \"/((?!_next/static|_next/image|favicon.ico).*)\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AACA;AAAA;;AAEO,SAAS,WAAW,GAAgB;IACzC,MAAM,MAAM,gMAAY,CAAC,IAAI;IAC7B,mBAAmB;IACnB,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACnC,IAAI,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC1C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACnC,IAAI,OAAO,CAAC,GAAG,CAAC,sBAAsB;IACtC,IAAI,OAAO,CAAC,GAAG,CAAC,6BAA6B;IAC7C,+DAA+D;IAC/D,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW;QAAC;QAAO;QAAM;QAAQ;KAAS,CAAC,QAAQ,CAAC,IAAI,MAAM,GAAG;QACnG,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC;QAC/B,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC;QAC7B,IAAI,UAAU,CAAC,OAAO,QAAQ,CAAC,QAAQ,KAAK;YAC1C,OAAO,IAAI,gMAAY,CAAC,aAAa;gBAAE,QAAQ;YAAI;QACrD;IACF;IACA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAe;KAAgD;AAC3E"}}]
}