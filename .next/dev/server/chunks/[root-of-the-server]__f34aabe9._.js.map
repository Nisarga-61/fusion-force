{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/lib/store.ts"],"sourcesContent":["// Simple in-memory store for MVP stubs. Replace with MongoDB later.\r\nexport type User = { userId: string; username: string; email?: string; passwordHash: string; did?: string; biometric?: { iv: string; tag: string; data: string } };\r\nexport type ZKPChallenge = { challengeId: string; userId: string; question: string; correctAnswerHash: string; misguideAnswers: string[]; createdAt: number; expiryTime: number };\r\nexport type VerificationRequest = { requestId: string; verifierId: string; holderId: string; requiredClaims: string[]; status: \"requested\" | \"presented\" | \"validated\"; createdAt: number; completedAt?: number };\r\nexport type Credential = { credentialId: string; userId: string; type: string; issuer: string; ipfsHash?: string; status: \"issued\" | \"revoked\" };\r\n\r\nexport const db = {\r\n  users: new Map<string, User>(),\r\n  zkp: new Map<string, ZKPChallenge>(),\r\n  verifications: new Map<string, VerificationRequest>(),\r\n  credentials: new Map<string, Credential>(),\r\n  revocations: new Set<string>(),\r\n};\r\n"],"names":[],"mappings":"AAAA,oEAAoE;;;;;AAM7D,MAAM,KAAK;IAChB,OAAO,IAAI;IACX,KAAK,IAAI;IACT,eAAe,IAAI;IACnB,aAAa,IAAI;IACjB,aAAa,IAAI;AACnB","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/app/api/auth/register/strict/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { randomUUID } from \"crypto\";\r\nimport { db } from \"@/lib/store\";\r\n\r\nconst usernameRe = /^[A-Za-z0-9]{3,20}$/;\r\nconst passwordRe = /^(?=.*[A-Z])(?=.*\\d)(?=.*[^A-Za-z0-9]).{8,}$/;\r\n\r\nexport async function POST(req: NextRequest) {\r\n  const body = await req.json().catch(() => ({}));\r\n  const { username = \"\", email = \"\", password = \"\" } = body || {};\r\n  if (!usernameRe.test(username)) {\r\n    return NextResponse.json({ ok: false, error: \"Invalid username\" }, { status: 400 });\r\n  }\r\n  if (!passwordRe.test(password)) {\r\n    return NextResponse.json({ ok: false, error: \"Weak password\" }, { status: 400 });\r\n  }\r\n  const exists = [...db.users.values()].some((u) => u.username.toLowerCase() === String(username).toLowerCase());\r\n  if (exists) return NextResponse.json({ ok: false, error: \"Username exists\" }, { status: 409 });\r\n  const salt = await bcrypt.genSalt(12);\r\n  const passwordHash = await bcrypt.hash(password, salt);\r\n  const userId = randomUUID();\r\n  db.users.set(userId, { userId, username, email, passwordHash });\r\n  return NextResponse.json({ ok: true, userId, username });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,aAAa;AACnB,MAAM,aAAa;AAEZ,eAAe,KAAK,GAAgB;IACzC,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IAC7C,MAAM,EAAE,WAAW,EAAE,EAAE,QAAQ,EAAE,EAAE,WAAW,EAAE,EAAE,GAAG,QAAQ,CAAC;IAC9D,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IACnF;IACA,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IAChF;IACA,MAAM,SAAS;WAAI,2HAAE,CAAC,KAAK,CAAC,MAAM;KAAG,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,WAAW,OAAO,OAAO,UAAU,WAAW;IAC3G,IAAI,QAAQ,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAO,OAAO;IAAkB,GAAG;QAAE,QAAQ;IAAI;IAC5F,MAAM,OAAO,MAAM,8IAAM,CAAC,OAAO,CAAC;IAClC,MAAM,eAAe,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;IACjD,MAAM,SAAS,IAAA,mHAAU;IACzB,2HAAE,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ;QAAE;QAAQ;QAAU;QAAO;IAAa;IAC7D,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM;QAAQ;IAAS;AACxD","debugId":null}}]
}