{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/components/WalletConnector.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ethers } from \"ethers\";\r\n\r\nexport default function WalletConnector({ onConnected }: { onConnected?: (account: string) => void }) {\r\n  const [account, setAccount] = useState<string>(\"\");\r\n  const [error, setError] = useState<string>(\"\");\r\n\r\n  const connect = async () => {\r\n    setError(\"\");\r\n    try {\r\n      if (!(window as any).ethereum) {\r\n        setError(\"MetaMask not found. Please install it.\");\r\n        return;\r\n      }\r\n      const provider = new ethers.BrowserProvider((window as any).ethereum);\r\n      const accounts = await provider.send(\"eth_requestAccounts\", []);\r\n      const acc = accounts[0];\r\n      setAccount(acc);\r\n      onConnected?.(acc);\r\n    } catch (e: any) {\r\n      setError(e?.message || \"Failed to connect wallet\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const eth = (window as any).ethereum;\r\n    if (!eth) return;\r\n    const handler = (accounts: string[]) => {\r\n      if (accounts?.[0]) setAccount(accounts[0]);\r\n    };\r\n    eth.on?.(\"accountsChanged\", handler);\r\n    return () => eth.removeListener?.(\"accountsChanged\", handler);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2\">\r\n      {account ? (\r\n        <span className=\"text-sm text-zinc-600\">{account.slice(0, 6)}...{account.slice(-4)}</span>\r\n      ) : (\r\n        <button onClick={connect} className=\"rounded-md bg-black px-3 py-2 text-white hover:bg-zinc-800\">\r\n          Connect Wallet\r\n        </button>\r\n      )}\r\n      {error && <span className=\"text-xs text-red-600\">{error}</span>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIe,SAAS,gBAAgB,EAAE,WAAW,EAA+C;IAClG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAS;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAS;IAE3C,MAAM,UAAU;QACd,SAAS;QACT,IAAI;YACF,IAAI,CAAC,AAAC,OAAe,QAAQ,EAAE;gBAC7B,SAAS;gBACT;YACF;YACA,MAAM,WAAW,IAAI,0LAAM,CAAC,eAAe,CAAC,AAAC,OAAe,QAAQ;YACpE,MAAM,WAAW,MAAM,SAAS,IAAI,CAAC,uBAAuB,EAAE;YAC9D,MAAM,MAAM,QAAQ,CAAC,EAAE;YACvB,WAAW;YACX,cAAc;QAChB,EAAE,OAAO,GAAQ;YACf,SAAS,GAAG,WAAW;QACzB;IACF;IAEA,IAAA,kNAAS,EAAC;QACR,MAAM,MAAM,AAAC,OAAe,QAAQ;QACpC,IAAI,CAAC,KAAK;QACV,MAAM,UAAU,CAAC;YACf,IAAI,UAAU,CAAC,EAAE,EAAE,WAAW,QAAQ,CAAC,EAAE;QAC3C;QACA,IAAI,EAAE,GAAG,mBAAmB;QAC5B,OAAO,IAAM,IAAI,cAAc,GAAG,mBAAmB;IACvD,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAI,WAAU;;YACZ,wBACC,8OAAC;gBAAK,WAAU;;oBAAyB,QAAQ,KAAK,CAAC,GAAG;oBAAG;oBAAI,QAAQ,KAAK,CAAC,CAAC;;;;;;qCAEhF,8OAAC;gBAAO,SAAS;gBAAS,WAAU;0BAA6D;;;;;;YAIlG,uBAAS,8OAAC;gBAAK,WAAU;0BAAwB;;;;;;;;;;;;AAGxD","debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/components/PasswordStrength.tsx"],"sourcesContent":["\"use client\";\r\nimport React from \"react\";\r\nimport zxcvbn from \"zxcvbn\";\r\n\r\nexport default function PasswordStrength({ value }: { value: string }) {\r\n  const result = React.useMemo(() => (value ? zxcvbn(value) : undefined), [value]);\r\n  const score = result?.score ?? 0; // 0-4\r\n  const labels = [\"Very weak\", \"Weak\", \"Fair\", \"Good\", \"Strong\"];\r\n  const colors = [\"bg-pink-700\", \"bg-pink-600\", \"bg-pink-500\", \"bg-pink-400\", \"bg-pink-300\"];\r\n  return (\r\n    <div aria-live=\"polite\" className=\"mt-1\">\r\n      <div className=\"flex h-2 w-full overflow-hidden rounded bg-zinc-800\">\r\n        {[0,1,2,3].map((i) => (\r\n          <div key={i} className={`h-2 flex-1 ${i <= score-1 ? colors[score] : \"bg-zinc-700\"}`}></div>\r\n        ))}\r\n      </div>\r\n      {value && <p className=\"mt-1 text-xs text-pink-300\">{labels[score]}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIe,SAAS,iBAAiB,EAAE,KAAK,EAAqB;IACnE,MAAM,SAAS,gNAAK,CAAC,OAAO,CAAC,IAAO,QAAQ,IAAA,gJAAM,EAAC,SAAS,WAAY;QAAC;KAAM;IAC/E,MAAM,QAAQ,QAAQ,SAAS,GAAG,MAAM;IACxC,MAAM,SAAS;QAAC;QAAa;QAAQ;QAAQ;QAAQ;KAAS;IAC9D,MAAM,SAAS;QAAC;QAAe;QAAe;QAAe;QAAe;KAAc;IAC1F,qBACE,8OAAC;QAAI,aAAU;QAAS,WAAU;;0BAChC,8OAAC;gBAAI,WAAU;0BACZ;oBAAC;oBAAE;oBAAE;oBAAE;iBAAE,CAAC,GAAG,CAAC,CAAC,kBACd,8OAAC;wBAAY,WAAW,CAAC,WAAW,EAAE,KAAK,QAAM,IAAI,MAAM,CAAC,MAAM,GAAG,eAAe;uBAA1E;;;;;;;;;;YAGb,uBAAS,8OAAC;gBAAE,WAAU;0BAA8B,MAAM,CAAC,MAAM;;;;;;;;;;;;AAGxE","debugId":null}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/app/auth/page.tsx"],"sourcesContent":["\"use client\";\r\nimport Link from \"next/link\";\r\nimport WalletConnector from \"@/components/WalletConnector\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { z } from \"zod\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport PasswordStrength from \"@/components/PasswordStrength\";\r\n\r\nconst usernameRe = /^[A-Za-z0-9]{3,20}$/;\r\nconst passwordRe = /^(?=.*[A-Z])(?=.*\\d)(?=.*[^A-Za-z0-9]).{8,}$/;\r\nconst Schema = z.object({\r\n  username: z.string().regex(usernameRe, \"3-20 alphanumeric\"),\r\n  email: z.string().email().optional().or(z.literal(\"\")),\r\n  password: z.string().regex(passwordRe, \"Min 8, 1 upper, 1 number, 1 special\"),\r\n});\r\n\r\ntype FormValues = z.infer<typeof Schema>;\r\n\r\nexport default function Page() {\r\n  const { register, handleSubmit, watch, formState: { errors } } = useForm<FormValues>({ resolver: zodResolver(Schema) });\r\n  const pwd = watch(\"password\") || \"\";\r\n\r\n  const onRegister = async (values: FormValues) => {\r\n    const res = await fetch(\"/api/auth/register/strict\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(values) });\r\n    const data = await res.json();\r\n    if (!res.ok) return alert(data.error || \"Registration failed\");\r\n    alert(\"Registered. You can login now.\");\r\n  };\r\n\r\n  const onLogin = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    const form = new FormData(e.currentTarget);\r\n    const username = String(form.get(\"l_username\") || \"\");\r\n    const password = String(form.get(\"l_password\") || \"\");\r\n    const res = await fetch(\"/api/auth/session\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ username, password }) });\r\n    const data = await res.json();\r\n    if (!res.ok) return alert(\"Invalid credentials\");\r\n    sessionStorage.setItem(\"access\", data.access);\r\n    alert(\"Logged in\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"mx-auto max-w-5xl space-y-8 p-6 bg-black text-white min-h-screen\">\r\n      <header className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-2xl font-semibold text-pink-400\">VERIFY EVERYTHING REVEAL NOTHING</h1>\r\n        <WalletConnector />\r\n      </header>\r\n      <div className=\"grid grid-cols-1 gap-6 md:grid-cols-2\">\r\n        <form aria-label=\"Register\" onSubmit={handleSubmit(onRegister)} className=\"rounded-xl border border-pink-700/40 bg-zinc-950 p-5 shadow-[0_0_30px_-10px_rgba(236,72,153,0.5)]\">\r\n          <h2 className=\"text-lg font-medium text-pink-300\">Create account</h2>\r\n          <label className=\"mt-3 block text-sm\">Username\r\n            <input aria-invalid={!!errors.username} className=\"mt-1 w-full rounded-md border border-pink-700 bg-black px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500\" {...register(\"username\")} placeholder=\"e.g. alice42\" />\r\n            {errors.username && <span className=\"text-xs text-pink-400\">{errors.username.message}</span>}\r\n          </label>\r\n          <label className=\"mt-3 block text-sm\">Email (optional)\r\n            <input className=\"mt-1 w-full rounded-md border border-pink-700 bg-black px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500\" {...register(\"email\")} placeholder=\"name@example.com\" />\r\n          </label>\r\n          <label className=\"mt-3 block text-sm\">Password\r\n            <input aria-invalid={!!errors.password} type=\"password\" className=\"mt-1 w-full rounded-md border border-pink-700 bg-black px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500\" {...register(\"password\")} placeholder=\"Min 8, Upper, Number, Special\" />\r\n            <PasswordStrength value={pwd} />\r\n            {errors.password && <span className=\"text-xs text-pink-400\">{errors.password.message}</span>}\r\n          </label>\r\n          <button type=\"submit\" className=\"mt-4 w-full rounded-md bg-pink-600 px-3 py-2 font-medium text-black hover:bg-pink-500\">Register</button>\r\n        </form>\r\n        <form aria-label=\"Login\" onSubmit={onLogin} className=\"rounded-xl border border-pink-700/40 bg-zinc-950 p-5 shadow-[0_0_30px_-10px_rgba(236,72,153,0.5)]\">\r\n          <h2 className=\"text-lg font-medium text-pink-300\">Login</h2>\r\n          <label className=\"mt-3 block text-sm\">Username\r\n            <input name=\"l_username\" className=\"mt-1 w-full rounded-md border border-pink-700 bg-black px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500\" placeholder=\"your username\" />\r\n          </label>\r\n          <label className=\"mt-3 block text-sm\">Password\r\n            <input name=\"l_password\" type=\"password\" className=\"mt-1 w-full rounded-md border border-pink-700 bg-black px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500\" placeholder=\"••••••••\" />\r\n          </label>\r\n          <button type=\"submit\" className=\"mt-4 w-full rounded-md bg-pink-600 px-3 py-2 font-medium text-black hover:bg-pink-500\">Login</button>\r\n          <div className=\"mt-4 space-y-2 text-sm\">\r\n            <Link href=\"/biometric\" className=\"text-pink-300 underline\">Retinal biometric</Link>\r\n            <div className=\"text-zinc-400\">ZKP: <Link href=\"/zkp\" className=\"text-pink-300 underline\">Challenge-Response</Link></div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}