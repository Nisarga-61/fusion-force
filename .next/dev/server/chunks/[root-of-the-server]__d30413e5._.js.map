{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/lib/store.ts"],"sourcesContent":["// Simple in-memory store for MVP stubs. Replace with MongoDB later.\r\nexport type User = { userId: string; username: string; email?: string; passwordHash: string; did?: string; biometric?: { iv: string; tag: string; data: string } };\r\nexport type ZKPChallenge = { challengeId: string; userId: string; question: string; correctAnswerHash: string; misguideAnswers: string[]; createdAt: number; expiryTime: number };\r\nexport type VerificationRequest = { requestId: string; verifierId: string; holderId: string; requiredClaims: string[]; status: \"requested\" | \"presented\" | \"validated\"; createdAt: number; completedAt?: number };\r\nexport type Credential = { credentialId: string; userId: string; type: string; issuer: string; ipfsHash?: string; status: \"issued\" | \"revoked\" };\r\n\r\nexport const db = {\r\n  users: new Map<string, User>(),\r\n  zkp: new Map<string, ZKPChallenge>(),\r\n  verifications: new Map<string, VerificationRequest>(),\r\n  credentials: new Map<string, Credential>(),\r\n  revocations: new Set<string>(),\r\n};\r\n"],"names":[],"mappings":"AAAA,oEAAoE;;;;;AAM7D,MAAM,KAAK;IAChB,OAAO,IAAI;IACX,KAAK,IAAI;IACT,eAAe,IAAI;IACnB,aAAa,IAAI;IACjB,aAAa,IAAI;AACnB","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/lib/jwt.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\nconst ACCESS_TTL = \"30m\";\r\nconst REFRESH_TTL = \"7d\";\r\n\r\nconst getSecret = () => {\r\n  const s = process.env.JWT_SECRET;\r\n  if (!s) throw new Error(\"JWT_SECRET missing\");\r\n  return s;\r\n};\r\n\r\nexport function signAccess(payload: Record<string, any>) {\r\n  return jwt.sign(payload, getSecret(), { expiresIn: ACCESS_TTL, algorithm: \"HS256\" });\r\n}\r\n\r\nexport function signRefresh(payload: Record<string, any>) {\r\n  return jwt.sign(payload, getSecret(), { expiresIn: REFRESH_TTL, algorithm: \"HS256\" });\r\n}\r\n\r\nexport function verifyToken<T = any>(token: string) {\r\n  return jwt.verify(token, getSecret()) as T;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,aAAa;AACnB,MAAM,cAAc;AAEpB,MAAM,YAAY;IAChB,MAAM,IAAI,QAAQ,GAAG,CAAC,UAAU;IAChC,IAAI,CAAC,GAAG,MAAM,IAAI,MAAM;IACxB,OAAO;AACT;AAEO,SAAS,WAAW,OAA4B;IACrD,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,aAAa;QAAE,WAAW;QAAY,WAAW;IAAQ;AACpF;AAEO,SAAS,YAAY,OAA4B;IACtD,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,aAAa;QAAE,WAAW;QAAa,WAAW;IAAQ;AACrF;AAEO,SAAS,YAAqB,KAAa;IAChD,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;AAC3B","debugId":null}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/OneDrive/Desktop/pixelgenesis/src/app/api/auth/session/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { db } from \"@/lib/store\";\r\nimport { signAccess, signRefresh, verifyToken } from \"@/lib/jwt\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  const body = await req.json().catch(() => ({}));\r\n  const { username = \"\", password = \"\" } = body || {};\r\n  const user = [...db.users.values()].find((u) => u.username.toLowerCase() === String(username).toLowerCase());\r\n  if (!user) return NextResponse.json({ ok: false }, { status: 401 });\r\n  const ok = await bcrypt.compare(password, user.passwordHash);\r\n  if (!ok) return NextResponse.json({ ok: false }, { status: 401 });\r\n\r\n  const access = signAccess({ sub: user.userId, username: user.username });\r\n  const refresh = signRefresh({ sub: user.userId, type: \"refresh\" });\r\n  const res = NextResponse.json({ ok: true, access });\r\n  res.cookies.set(\"refresh_token\", refresh, { httpOnly: true, sameSite: \"lax\", secure: true, path: \"/\", maxAge: 60 * 60 * 24 * 7 });\r\n  return res;\r\n}\r\n\r\nexport async function PUT(req: NextRequest) {\r\n  const cookies = req.cookies.get(\"refresh_token\")?.value;\r\n  if (!cookies) return NextResponse.json({ ok: false }, { status: 401 });\r\n  try {\r\n    const payload = verifyToken<{ sub: string; type: string }>(cookies);\r\n    if (payload.type !== \"refresh\") return NextResponse.json({ ok: false }, { status: 401 });\r\n    const user = db.users.get(payload.sub);\r\n    if (!user) return NextResponse.json({ ok: false }, { status: 401 });\r\n    const access = signAccess({ sub: user.userId, username: user.username });\r\n    const res = NextResponse.json({ ok: true, access });\r\n    // Optionally rotate refresh here\r\n    return res;\r\n  } catch {\r\n    return NextResponse.json({ ok: false }, { status: 401 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IAC7C,MAAM,EAAE,WAAW,EAAE,EAAE,WAAW,EAAE,EAAE,GAAG,QAAQ,CAAC;IAClD,MAAM,OAAO;WAAI,2HAAE,CAAC,KAAK,CAAC,MAAM;KAAG,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,WAAW,OAAO,OAAO,UAAU,WAAW;IACzG,IAAI,CAAC,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAM,GAAG;QAAE,QAAQ;IAAI;IACjE,MAAM,KAAK,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;IAC3D,IAAI,CAAC,IAAI,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAM,GAAG;QAAE,QAAQ;IAAI;IAE/D,MAAM,SAAS,IAAA,iIAAU,EAAC;QAAE,KAAK,KAAK,MAAM;QAAE,UAAU,KAAK,QAAQ;IAAC;IACtE,MAAM,UAAU,IAAA,kIAAW,EAAC;QAAE,KAAK,KAAK,MAAM;QAAE,MAAM;IAAU;IAChE,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM;IAAO;IACjD,IAAI,OAAO,CAAC,GAAG,CAAC,iBAAiB,SAAS;QAAE,UAAU;QAAM,UAAU;QAAO,QAAQ;QAAM,MAAM;QAAK,QAAQ,KAAK,KAAK,KAAK;IAAE;IAC/H,OAAO;AACT;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,UAAU,IAAI,OAAO,CAAC,GAAG,CAAC,kBAAkB;IAClD,IAAI,CAAC,SAAS,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAM,GAAG;QAAE,QAAQ;IAAI;IACpE,IAAI;QACF,MAAM,UAAU,IAAA,kIAAW,EAAgC;QAC3D,IAAI,QAAQ,IAAI,KAAK,WAAW,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAM,GAAG;YAAE,QAAQ;QAAI;QACtF,MAAM,OAAO,2HAAE,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,GAAG;QACrC,IAAI,CAAC,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAM,GAAG;YAAE,QAAQ;QAAI;QACjE,MAAM,SAAS,IAAA,iIAAU,EAAC;YAAE,KAAK,KAAK,MAAM;YAAE,UAAU,KAAK,QAAQ;QAAC;QACtE,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAO;QACjD,iCAAiC;QACjC,OAAO;IACT,EAAE,OAAM;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAM,GAAG;YAAE,QAAQ;QAAI;IACxD;AACF","debugId":null}}]
}